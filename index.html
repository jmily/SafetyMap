<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Safety Map</title>
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="css/custom-select.css" />
    <link href="css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.3/leaflet.css" />
    <script src="js/leaflet.js"></script>
    <script type="text/javascript" src="js/modernizr.custom.79639.js"></script>
</head>
<body>
 <div class="container">
      <h1>Melbourne Road Safety Portal</h1>
     <div id="summary">
         Australia has achieved substantial reductions in road crash fatalities over the last 30 years, despite a 50 per cent growth in population and a two-fold increase in registered motor vehicles. Between 1980 and 2010, the nation’s annual road fatality rate declined from 22.3 to 6.1 deaths per 100,000 people. However, it is still estimated that on average, around 1,400 people die and 33,000 are seriously injured each year on Australian roads. The Australian Bureau of Infrastructure, Transport and Regional Economics (BITRE) estimated that the annual cost of road trauma to the Australian society is 17.85 billion AUD.
         <br><br>In this project, we visualize crash data in Melbourne at the Statistical Area Level 2 (SA2), defined by the Australian Bureau of Statistics. We obtained the crash data from VicRoads between the years for 2010 to 2012. During this period, a total of 12,206 crashes were reported.  Total number of crashes were decreasing from 2010 to 2012.
     </div>

     <div class="wrapper-demo">
         <div id="dd" class="wrapper-dropdown-3" tabindex="1">
             <span>Total Population Density</span>
             <ul class="dropdown">
                 <li id="density-p"><a href="#"><i class="icon-envelope icon-large"></i>Total Population Density</a></li>
                 <li id="vehicle-p"><a href="#"><i class="icon-truck icon-large"></i>Vehicle Kilometers Travelled (million)</a></li>
                 <li id="crash-p"><a href="#"><i class="icon-plane icon-large"></i>Total Crashes</a></li>
                 <li id="crash-4-p"><a href="#"><i class="icon-plane icon-large"></i>Crashes in which a 4-16 year old involved</a></li>
                 <li id="crash-60-p"><a href="#"><i class="icon-plane icon-large"></i>Crashes in which a 60+ year old involved</a></li>
                 <li id="bike-p"><a href="#"><i class="icon-plane icon-large"></i>Bicycle Crashes</a></li>
                 <li id="pedestrian-p"><a href="#"><i class="icon-plane icon-large"></i>Pedestrian Crashes</a></li>
                 <li id="motor-p"><a href="#"><i class="icon-plane icon-large"></i>Motorbike Crashes</a></li>
                 <li id="truck-p"><a href="#"><i class="icon-plane icon-large"></i>Truck Crashes</a></li>
                 <li id="fatal-p"><a href="#"><i class="icon-plane icon-large"></i>Fatal Crashes</a></li>
                 <li id="severe-p"><a href="#"><i class="icon-plane icon-large"></i>Severe Injury Crashes</a></li>
                 <li id="night-p"><a href="#"><i class="icon-plane icon-large"></i>Nighttime Crashes</a></li>
                 <li id="weekday-p"><a href="#"><i class="icon-plane icon-large"></i>Weekday Crashes</a></li>
                 <li id="weekend-p"> <a href="#"><i class="icon-plane icon-large"></i>Weekend Crashes</a></li>
             </ul>
         </div>
         ​</div>


     <div id="map">

     </div>
     <div class="leaflet-control-container">
<div class="leaflet-top leaflet-left">
     <div class="leaflet-control-zoom leaflet-bar leaflet-control">
     <div id="zoom-in" class="zoom-btn leaflet-control-zoom-in">+</div>
     <div id="zoom-out" class="zoom-btn leaflet-control-zoom-out">-</div>
     </div>
    </div>
     </div>
     <div class="chart-title">Title of the chart</div>
     <div id="chart-des">description of the chart here...</div>
     <div id="chartdiv" style="width: 80%; height: 400px; margin-left:auto; margin-right: auto;"></div>
 </div>


 <div id="tooltip">
     <div id="title"></div>
     <div id="content"></div>
 </div>



 <script src="js/amcharts.js" type="text/javascript"></script>
 <script src="js/serial.js" type="text/javascript"></script>
 <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
 <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>

 <script src="js/d3.min.js"></script>
 <script src="js/topojson.min.js"></script>
 <script src="js/map.js"></script>


 <script>
     $('button').hover(function(){
         if($(this).attr('class')!= 'btn-clicked') {
             $(this).removeClass("btn");
             $(this).removeClass("btn-clicked").addClass("btn-active");
         }

     }, function()
     {
           if($(this).attr('class')!= 'btn-clicked') {

               $(this).removeClass("btn-active").addClass("btn");
           }
     });


     $('button').click(function(){
         $('.btn-clicked').each(function()
         {
             $(this).removeClass("btn-clicked").addClass("btn");

         });
         $(this).removeClass("btn");
         $(this).removeClass("btn-active").addClass("btn-clicked");

     });


     $("#tooltip").hide();


 </script>


 <script type="text/javascript">
     var chart;

     var chartData = [
         {
             "year": 2010,
             "Fatal": 53,
             "Serious Injury": 1591,
             "Other Injury": 2985
         },
         {
             "year": 2011,
             "Fatal": 62,
             "Serious Injury": 1332,
             "Other Injury": 2501
         },
         {
             "year": 2012,
             "Fatal": 50,
             "Serious Injury": 1290,
             "Other Injury": 2345
         }
     ];

     AmCharts.ready(function () {
         // SERIALL CHART
         chart = new AmCharts.AmSerialChart();
         chart.dataProvider = chartData;
         chart.categoryField = "year";
         chart.plotAreaBorderAlpha = 0.2;
//         chart.rotate = true;

         // AXES
         // Category
         var categoryAxis = chart.categoryAxis;
         categoryAxis.gridAlpha = 0.1;
         categoryAxis.axisAlpha = 0;
         categoryAxis.gridPosition = "start";

         // value
         var valueAxis = new AmCharts.ValueAxis();
         valueAxis.stackType = "regular";
         valueAxis.gridAlpha = 0.1;
         valueAxis.axisAlpha = 0;
         chart.addValueAxis(valueAxis);

         // GRAPHS
         // firstgraph
         var graph = new AmCharts.AmGraph();
         graph.title = "Fatal Injury";
         graph.labelText = "[[value]]";
         graph.valueField = "Fatal";
         graph.type = "column";
         graph.lineAlpha = 0;
         graph.fillAlphas = 1;
         graph.lineColor = "#27477a";
         graph.balloonText = "<b><span style='color:#27477a'>[[title]]</b></span><br><span style='font-size:14px'>[[category]]: <b>[[value]]</b></span>";
         graph.labelPosition = "middle";
         chart.addGraph(graph);

         // second graph
         graph = new AmCharts.AmGraph();
         graph.title = "Serious Injury";
         graph.labelText = "[[value]]";
         graph.valueField = "Serious Injury";
         graph.type = "column";
         graph.lineAlpha = 0;
         graph.fillAlphas = 1;
         graph.lineColor = "#b60c36";
         graph.balloonText = "<b><span style='color:#b60c36'>[[title]]</b></span><br><span style='font-size:14px'>[[category]]: <b>[[value]]</b></span>";
         graph.labelPosition = "middle";
         chart.addGraph(graph);

         // third graph
         graph = new AmCharts.AmGraph();
         graph.title = "Other Injury";
         graph.labelText = "[[value]]";
         graph.valueField = "Other Injury";
         graph.type = "column";
         graph.lineAlpha = 0;
         graph.fillAlphas = 1;
         graph.lineColor = "#07a36b";
         graph.balloonText = "<b><span style='color:#07a36b'>[[title]]</b></span><br><span style='font-size:14px'>[[category]]: <b>[[value]]</b></span>";
         graph.labelPosition = "middle";
         chart.addGraph(graph);



         // LEGEND
         var legend = new AmCharts.AmLegend();
         legend.position = "right";
         legend.borderAlpha = 0.3;
         legend.horizontalGap = 10;
         legend.switchType = "v";
         chart.addLegend(legend);

         chart.creditsPosition = "top-right";

         // WRITE
         chart.write("chartdiv");
     });

     // Make chart 2D/3D
     function setDepth() {
         if (document.getElementById("rb1").checked) {
             chart.depth3D = 0;
             chart.angle = 0;
         } else {
             chart.depth3D = 20;
             chart.angle = 30;
         }
         chart.validateNow();
     }
 </script>

 <script type="text/javascript">

     function DropDown(el) {
         this.dd = el;
         this.placeholder = this.dd.children('span');
         this.opts = this.dd.find('ul.dropdown > li');
         this.val = '';
         this.index = -1;
         this.initEvents();
     }
     DropDown.prototype = {
         initEvents : function() {
             var obj = this;

             obj.dd.on('click', function(event){
                 $(this).toggleClass('active');
                 return false;
             });

             obj.opts.on('click',function(){
                 var opt = $(this);
                 obj.val = opt.text();
                 obj.index = opt.index();
                 obj.placeholder.text(obj.val);
             });
         },
         getValue : function() {
             return this.val;
         },
         getIndex : function() {
             return this.index;
         }
     }

     $(function() {

         var dd = new DropDown( $('#dd') );

         $(document).click(function() {
             // all dropdowns
             $('.wrapper-dropdown-3').removeClass('active');
         });

     });

 </script>
</body>
</html>